#!/bin/bash
  
  readonly progName=$(/usr/bin/basename ${0})
  readonly progVersion="1.2"
  
  if [[ "${EUID}" -ne 0 ]]; then
    echo "${progName}: This application must be run as root" && exit 1
  fi

  if [ -t 1 ]; then
    readonly boldEcho=$(/usr/bin/tput bold)
    readonly normalEcho=$(/usr/bin/tput sgr0)
    readonly redEcho=$(/usr/bin/tput setaf 1)
    readonly greenEcho=$(/usr/bin/tput setaf 2)
    readonly blueEcho=$(/usr/bin/tput setaf 4)
    readonly yellowEcho=$(/usr/bin/tput setaf 3)
  else
    readonly boldEcho=""
    readonly normalEcho=""
    readonly redEcho=""
    readonly greenEcho=""
    readonly blueEcho=""
    readonly yellowEcho=""
  fi
  
  readonly downloadURI="${1}"

  if [ -z "${1}" ]; then
    echo "Error: Invalid argument" && exit 1
  fi
  
  if [ ! -s "/usr/local/bin/download-helper" ]; then
    echo "Error: Please install aky Patch Management" && exit 1
  fi
  
  downloadedFile=$(/usr/local/bin/download-helper "${downloadURI}")
  computedChecksum=$(/usr/bin/shasum -a 256 -p "${downloadedFile}" | cut -d' ' -f1)
  
  fileName=$(/usr/bin/basename "${downloadedFile}")
  fileExtension=${fileName##*.}
  fileBasename="${fileName%.*}"
  
  echo "${boldEcho}Filename${normalEcho}          '${boldEcho}${blueEcho}${fileBasename}${normalEcho}.${boldEcho}${yellowEcho}${fileExtension}${normalEcho}'"
  echo "${boldEcho}SHA-256 Checksum${normalEcho}  '${boldEcho}${greenEcho}${computedChecksum}${normalEcho}'"
  
  rm -rf "${downloadedFile}"